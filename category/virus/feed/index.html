<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Virus &#8211; $Tchernobyl.ml !</title>
	<atom:link href="blog.tchernobyl.ml/category/virus/feed/" rel="self" type="application/rss+xml" />
	<link>https://blog.tchernobyl.ml/</link>
	<description></description>
	<lastBuildDate>Fri, 21 Jun 2019 04:57:17 +0000</lastBuildDate>
	<language>fr-FR</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=5.2.2</generator>

<image>
	<url>https://blog.tchernobyl.ml/wp-content/uploads/2019/07/cropped-favicon-1-32x32.png</url>
	<title>Virus &#8211; $Tchernobyl.ml !</title>
	<link>https://blog.tchernobyl.ml/</link>
	<width>32</width>
	<height>32</height>
</image> 
	<item>
		<title>Enquête: campagne russe de phishing via SMS sur leboncoin</title>
		<link>https://blog.tchernobyl.ml/drama-alert/enquete-campagne-russe-de-phishing-via-sms-sur-leboncoin/</link>
				<comments>https://blog.tchernobyl.ml/drama-alert/enquete-campagne-russe-de-phishing-via-sms-sur-leboncoin/#comments</comments>
				<pubDate>Fri, 21 Jun 2019 04:57:17 +0000</pubDate>
		<dc:creator><![CDATA[Tch3rn0byl]]></dc:creator>
				<category><![CDATA[Drama Alert]]></category>
		<category><![CDATA[Éditos]]></category>
		<category><![CDATA[Système]]></category>
		<category><![CDATA[Vie Privée]]></category>
		<category><![CDATA[Virus]]></category>

		<guid isPermaLink="false">https://blog.tchernobyl.ml/?p=1061</guid>
				<description><![CDATA[<div class="post-excerpt">Coucou tout le monde, Si je vous dis: campagne de phishing massive, botnet russe, AndroidBanker et Leboncoin vous me répondez quoi ? Si vous avez répondu à haute voix (ou&#8230;</div><div class="post-more"><a href="https://blog.tchernobyl.ml/drama-alert/enquete-campagne-russe-de-phishing-via-sms-sur-leboncoin/" class="btn btn-primary btn-effect btn-lg"><span>Lire l&#039;Article</span><span><i class="icon icon-arrow-right"></i></span></a></div>]]></description>
								<content:encoded><![CDATA[<p>Coucou tout le monde, </p>
<p>Si je vous dis: campagne de phishing massive, botnet russe, AndroidBanker et Leboncoin vous me répondez quoi ? </p>
<p>Si vous avez répondu à haute voix (ou pas) « ARTICLE BIEN JUTEUX !!! » alors vous l&rsquo;avez dans le mille :)</p>
<p>Internet est vaste et rempli de tous pleins de mystères. Et c&rsquo;est justement ce côté mystérieux qui me passionne. Vous comprenez donc que lorsque l&rsquo;on me tend un billet express pour découvrir les coulisses d&rsquo;une attaque (surtout comme celle-ci) je ne réfléchis pas deux fois !</p>
<h3>1°) Le Contexte</h3>
<p>Récement un de mes amis qui avait mis en vente un objet sur le leboncoin avait reçu un SMS lui notifiant qu&rsquo;il avait bien reçu le prépaiement de l&rsquo;objet en question.</p>
<pre>[pseudo de mon ami] je vous ai envoyé le prepaiement www-leboncoin.com/357143040654321870</pre>
<p>Avant d&rsquo;écrire cet article j&rsquo;ai essayé de voir si on en parlait ailleurs, et vous pourrez d&rsquo;ailleurs le vérifier, il n&rsquo;y a que le forum UFC qui en parle ainsi qu&rsquo;un Tweet de l&rsquo;ami benkow_ le tout sans trop rentrer dans le détail.</p>
<blockquote class="twitter-tweet" data-lang="en">
<p lang="en" dir="ltr">hxxp://cd78cg210xy0[.]com/3lfk3jGj/admindo/login.php Android SMS Loader. Was used to spread a banker (apk) targeting french people last week <a href="https://t.co/Fup7hvRUKX">https://t.co/Fup7hvRUKX</a> <a href="https://t.co/5M1MGryN9T">pic.twitter.com/5M1MGryN9T</a></p>
<p>&mdash; Benkøw moʞuƎq (@benkow_) <a href="https://twitter.com/benkow_/status/1082229806190731265?ref_src=twsrc%5Etfw">January 7, 2019</a></p></blockquote>
<p>Une fois le lien ouvert, une page similaire à celle du tweet est affiché. Bien sûr, le contenu ne peut pas s&rsquo;afficher en entier si on ne télécharge bien évidemment pas l&rsquo;appli. Et puis là, comme pour signifier l&rsquo;excitation de l&rsquo;auteur, les fautes de français se multiplient juqu&rsquo;au drame&#8230;</p>
<p>La plupart des utilisateurs qui se font avoir par cette hideuse arnaque sont sauvés grâce à cet écran: </p>
<p> <img src="https://www.pronosoft.com/fr/appli/android/msg.png" /> </p>
<p>Ou encore grâce à celui-là pour les moins soucieux:</p>
<p> <img src="https://img1.koplayer.com/ScreenShot/com.antivirus/corwdYPO6EJ0GSM0-KSfKDDvF6aleCuEP93xqz2MryFdh7A3dKbupAcbMfoTZnKQ3jxc_50.png" /> </p>
<p>Eh oui! Bien que troublante d&rsquo;ingéniosité sur de nombreux points, cette campagne tombe à l&rsquo;eau car nombreux sont à avoir reçu la notif mais peu sont allé juqu&rsquo;à tout faire pour avoir le petit fichier .apk installé sur leur téléphone.</p>
<h3>2°) La charge utile (le fichier .apk)</h3>
<p>Le fichier est très léger (pour une application :) ), pas plus de 300 Ko.<br />
Dès son execution, la fausse appli va se connecter au faux site afin que la victime puisse entrer ses coordonnées bancaires (bye bye les sous-sous).<br />
Une fois cela fait, une connexion directe avec le serveur de Contrôle et de Commande (C2C) va s&rsquo;opérer et via un fichier « gate.php », le serveur donne au zombie une sorte de mutex (en gros un identifiant, ex: 543759810537698240). </p>
<p>Et c&rsquo;est là, que ça devient marrant: </p>
<p>Les auteurs semblent avoir initialement prévu de s&rsquo;occuper d&rsquo;un botnet android via HTTP totalement soumis et dévoué à son C2C (serveur de Contrôle et de Commande). Le truc, c&rsquo;est que sur Android, il n&rsquo;y a pas vraiment de véritables moyens de persistance comme sur d&rsquo;autres systèmes :( . </p>
<p>Par exemple, la permission d&rsquo;exécution en arrière-plan est choisie par l&rsquo;utilisateur lors de l&rsquo;installation et même si elle est activée, rien ne garantie que le démon (le service de l&rsquo;application) va bien se lancer de manière autonome après un redémarrage du téléphone. </p>
<p>Sans parler du fait qu&rsquo;un téléphone portable reste rarement au même endroit (logique en même temps) et que du coup Internet ne va pas forcément fonctionner tout le temps (surtout si la victime est un prolétaire avec un forfait Internet tout pourri :) ) </p>
<p>Mais ne vous en faites pas, de ce côté les auteurs ont eu une idée de génie pour propager le malware (si si vraiment). Aller je vous donne un indice, voici les permissions que la fausse application demande au moment de l&rsquo;installation:</p>
<pre>
    android.permission.CALL_PHONE          
    android.permission.CHANGE_WIFI_STATE
    android.permission.GET_TASKS
    android.permission.INTERNET           
    android.permission.READ_PHONE_STATE
    android.permission.READ_SMS
    android.permission.RECEIVE_SMS
    android.permission.SEND_SMS
    android.permission.SYSTEM_ALERT_WINDOW
    android.permission.BIND_ACCESSIBILITY_SERVICE
    android.permission.ACCESS_NETWORK_STATE
    android.permission.ACCESS_WIFI_STATE
    android.permission.CHANGE_NETWORK_STATE
    android.permission.REAL_GET_TASKS
    android.permission.RECEIVE_BOOT_COMPLETED
    android.permission.USES_POLICY_FORCE_LOCK
    android.permission.VIBRATE
    android.permission.WAKE_LOCK
    android.permission.WRITE_SETTINGS</pre>
<p>Bon je l&rsquo;avoue il n&rsquo;y a rien de très exatraordinaire là-dedans étant donné qu&rsquo;il s&rsquo;agit de permissions de backdoor tout ce qu&rsquo;il y a de plus standard&#8230; à part un tout petit détail. Le genre de tout petit détail qu&rsquo;on zappe sur le moment mais qu&rsquo;une fois qu&rsquo;on tilte on se dit « Non de Zeus ! »</p>
<p> <img src="https://media1.tenor.com/images/e0cb7e6a71710790fea998bd723f85a9/tenor.gif" /> </p>
<p>En effet, lorsque je menais mon enquête avec mon ami (que je remercie au passage), nous sommes tombés sur ce <a href="https://forum.quechoisir.org/prepaiement-leboncoin-arnaque-t202367.html" rel="noopener noreferrer" target="_blank">topic</a> du forum UFC que choisir</p>
<p>C&rsquo;est plus précisément ce passage qui nous intéresse ici: </p>
<p>« j&rsquo;ai contacté le 06 qui m&rsquo;a envoyé ce message, la presonne m&rsquo;a répondu, il était asellé de coup de téléphone comme le mien !! Lui avait réussi à installer le .apk où on lui demandait de fournir ses coordonnées bancaires pour finaliser le prépaiement !! »</p>
<p>Quand on lit ça, on se dit « Bien évidemment que l&rsquo;expéditeur a réussi à installer le .apk, c&rsquo;est le méchant pirate! En plus trop marrant il se fait harceler par les victimes #trop_drôle ! »</p>
<p>Oui mais non! Vous souvenez de l&rsquo;identifiant généré par le fichier « gate.php » sur le faux site ? Et de l&rsquo;identifiant dans l&rsquo;URL du SMS envoyé à la victime ?</p>
<p>Vous l&rsquo;avez sans doute compris, le SMS reçu par la victime a été en réalité envoyé par&#8230; une autre victime et ce totalement à son insu !</p>
<p>Et ça, c&rsquo;est du génie. En effet, plutôt que d&rsquo;envoyer eux-même le SMS de phishing et ainsi laisser leur numéro de téléphone, en soit une preuve qui pourrait directement nous conduire à eux, les auteurs se servent des téléphones backdoorés afin de relayer les messages aux victimes potentielles. </p>
<p>Le seul hic dans cette technique de génie, c&rsquo;est qu&rsquo;il semblerait que les pirates aient mal implémenté leur trouvaille. En effet, le fait que l&rsquo;expéditeur du fameux message de phishing soit harcelé, indique très clairement que la façon de faire des pirates est très peu réfléchie. Ce qui est plutôt paradoxal quand on voit l&rsquo;arsenal, digne des plus grands groupes de cybercriminels, déployé pour cette campagne de phishing.</p>
<p>Pour illustrer un peu mieux mes propos laissez moi vous faire une petite liste :</p>
<h4>Les arguments qui tendent à prouver qu&rsquo;il s&rsquo;agisse de script-kiddies:</h4>
<ul>
<li>TOUS les virus ayant un lien avec cette organisation sont détectés par une vaste majorité d&rsquo;antivirus</li>
<li>Les certificats sont auto-signés à l&rsquo;arrache (Ex: « CN:dddddddd fdfd » pour la backdoor leboncoin) alors qu&rsquo;ils ont des milliers de domaines</li>
<li>Les auteurs ne ciblent *exclusivement* que deux plateformes: Windows et Android, à croire qu&rsquo;ils ne connaissent que ces deux-là :) </li>
<li>Certains codes sont des copiés collés de code retrouvé sur Github, Pastebin ou même StackOverflow (les crédits en moins)</li>
<li>Il est très facile de remonter à leur serveur de Contrôle et de Commande </li>
<li>Certains de leurs virus sont de véritables « call center » avec plus d&rsquo;une centaine d&rsquo;addresses IP différentes contactées dès les premières secondes de l&rsquo;exécution</li>
<li>Ils utilisent Virus Total pour voir si leur Backdoors sont détectés par des antivirus</li>
</ul>
<h4>Maintenant quelques points qui, je dois le reconnaître montrent le caractère quelque peu « déterminé » des auteurs :</h4>
<ul>
<li>Beaucoup *beaucoup* de serveurs (majoritairement russes d&rsquo;ailleurs)</li>
<li>Véritable gestion du versionnage des logiciels malveillants</li>
<li>Utilisation et implémentation de fonctions cryptographiques (RSA notamement)</li>
<li>Exportation des attaques (d&rsquo;abord en Russie, puis en Chine et récemment en France avec l&rsquo;arnaque leboncoin)</li>
<li>Énormément (des milliers) de noms de domaines enregistrés en moins de 6 mois (essentiellement à des fins de phishing)</li>
<li>Portabilité de l&rsquo;infrastructure de contrôle (elle change d&rsquo;adresse IP / Web régulièrement)</li>
<li>Suppression des traces dans le code (version de l&rsquo;IDE, date de compilation)</li>
</ul>
<h5>Point additionnel: </h5>
<p>Mon ami et moi avions réussi à trouver leur serveur de contrôle et de commande. En revanche, il ne ressemblait à rien de ce qui se faisait ailleurs. La page d&rsquo;accueil du serveur Web affichait une page par défaut Apache / Cent OS alors que les headers HTTP affichait très clairement Nginx. Après vérification on trouvera par la suite qu&rsquo;il s&rsquo;agissait d&rsquo;une version d&rsquo;Ubuntu. </p>
<p>En cherchant un peu on a même réussi à trouver une véritable vulnérabilité en or massif qui nous a permis de confirmer qu&rsquo;il s&rsquo;agissait d&rsquo;une solution totalement custom. Pour la petite histoire on a d&rsquo;ailleurs retrouvé des traces de précédentes installations (test ?) non fonctionnelles sur deux sites compromis d&rsquo;entreprises (1 américaine et 1 indienne).</p>
<h3>3°) Verdict </h3>
<p>Cette attaque a sur le papier largement de quoi effrayer de par sa sophistication (copie conforme des codes graphiques leboncoin, utilisation de la nouvelle fonctionnalité de prépaiement comme prétexte pour le phishing, relai SMS des victimes pour propager le malware &#8230;). Cependant, dans les faits, l&rsquo;attaque n&rsquo;ébranle pas forcément voire carrément pas du tout la communauté leboncoin.</p>
<p>Honnêtement j&rsquo;ai presque de la peine pour les auteurs lorsque je vois toutes les bonnes idées et tous les efforts qu&rsquo;ils ont fournis en créant leurs propres trucs de A à Z mais que pas de bol, le truc à totalement bidé. Comme quoi, le crime ne paie pas :) </p>
<p><u>TELEX:</u> en guise de contre-mesure simple mais efficace, pensez seulement à être plus attentif aux liens avant de cliquer directement.</p>
<h3>Bonus: IOC&rsquo;s de la campagne </h3>
<pre>
hxxp://gb-leboncoin[.]info
hxxp://uk-leboncoin[.]info
hxxp://uk-leboncoin[.]top
hxxp://gb-leboncoin[.]top
hxxp://www.m-leboncoin[.]info
hxxp://www.gb-leboncoin[.]top
hxxp://www.e-leboncoin[.]info
hxxp://www.u-leboncoin[.]info
hxxp://www.www-leboncoin[.]info
hxxp://www.e-leboncoin[.]top
hxxp://www.gb-leboncoin[.]info
hxxp://fr-leboncoin[.]top
hxxp://a-leboncoin[.]top
hxxp://t-leboncoin[.]info
hxxp://www.uk-leboncoin[.]info
hxxp://www.mob-leboncoin[.]info
hxxp://www.a-leboncoin[.]top
hxxp://leboncoin-ql[.]top
hxxp://fr-leboncoin[.]info
hxxp://mob-leboncoin[.]info
hxxp://www.uk-leboncoin[.]top
hxxp://u-leboncoin[.]info
hxxp://www.mob-leboncoin[.]top
hxxp://www.t-leboncoin[.]top
hxxp://m-leboncoin[.]info
hxxp://www.leboncoin-ql[.]top
hxxp://u-leboncoin[.]top
hxxp://od-leboncoin[.]info
hxxp://www.od-leboncoin[.]info
hxxp://www.fr-leboncoin[.]info
hxxp://www.t-leboncoin[.]info
hxxp://llc-leboncoin[.]top
hxxp://www.llc-leboncoin[.]top
hxxp://www.u-leboncoin[.]top
hxxp://www-leboncoin[.]info
hxxp://www.od-leboncoin[.]top
hxxp://t-leboncoin[.]top
hxxp://e-leboncoin[.]top
hxxp://od-leboncoin[.]top
hxxp://mob-leboncoin[.]top
hxxp://e-leboncoin[.]info
hxxp://www.fr-leboncoin[.]top
hxxp://leboncoin-xc[.]top
hxxp://a-leboncoin[.]info
hxxp://my-leboncoin[.]top
hxxp://www.my-leboncoin[.]top
hxxp://www.a-leboncoin[.]info
hxxp://www.llc-leboncoin[.]info
hxxp://www.leboncoin-ql[.]info
hxxp://my-leboncoin[.]info
hxxp://www.leboncoin-tr[.]top
hxxp://leboncoin-tr[.]top
hxxp://www.my-leboncoin[.]info
hxxp://llc-leboncoin[.]info
hxxp://leboncoin-ql[.]info
hxxp://leboncoin-bk[.]top
hxxp://www.leboncoin-my[.]top
hxxp://leboncoin-my[.]info
hxxp://www.leboncoin-bk[.]top
hxxp://leboncoin-my[.]top
hxxp://www.leboncoin-my[.]info
hxxp://leboncoin-bk[.]info
hxxp://leboncoin-tr[.]info
hxxp://www.leboncoin-tr[.]info
hxxp://www.leboncoin-bk[.]info
hxxp://www.leboncoin-vd[.]info
hxxp://leboncoin-vd[.]top
hxxp://leboncoin-vd[.]info
hxxp://www.leboncoin-vd[.]top
hxxp://leboncoin-cz[.]top
hxxp://www.leboncoin-cz[.]top
hxxp://www.leboncoin-cz[.]info
hxxp://leboncoin-cz[.]info
hxxp://leboncoin-jp[.]top
hxxp://leboncoin-jp[.]info
hxxp://leboncoin-xc[.]info
hxxp://www.leboncoin-xc[.]info
hxxp://www.leboncoin-jp[.]info
hxxp://www.leboncoin-jp[.]top
hxxp://leboncoin-mp[.]top
hxxp://www.leboncoin-xc[.]top
hxxp://leboncoin-lx[.]top
hxxp://leboncoin-lp[.]info
hxxp://leboncoin-ml[.]top
hxxp://leboncoin-kp[.]top
hxxp://leboncoin-kz[.]top
hxxp://leboncoin-lv[.]top
hxxp://leboncoin-sl[.]top
hxxp://arbeit.jobs-hegele[.]in

08/05/2019 com.bertjerts 172eb70cd27b6d24b47abe39c887c2fd6164f238a4c18877aad139c1de9ed6a9
08/05/2019 com.backsmart a289da988c92c9889c0efb9901b5e875fb2a37dbb0cbd31708dba647bdf4c403
12/05/2019 com.bertrander 5f7b91bcd4877802a5b1a69bb322fa934d4a9ec1b5ac1a472636de57c33e07c3
18/05/2019 com.jertay 1bc805d19613bbab15027bd7d29a5bc3b8709bff0c7fd49cf04bb998cfc09b0d
08/06/2019 com.garson f22ea76a0d69cf03915fd17f6472b790c21fecea70ff94520cbed71e8eeba198

11/06/2019 com.lebronjoin b9610d39792609dc56fe0058571ec786df65e43e522d123eb26b5c5532737234 (WTF le nom ?)
11/06/2019 com.berlins 225023859abbad7f788a47dd72ea3b702799360b50b69dc670b6fb1c02e5bf64

</pre>
]]></content:encoded>
							<wfw:commentRss>https://blog.tchernobyl.ml/drama-alert/enquete-campagne-russe-de-phishing-via-sms-sur-leboncoin/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
							</item>
		<item>
		<title>Malware Hunting 2/? : La fin de DarkComet</title>
		<link>https://blog.tchernobyl.ml/fun/malware-hunting-2-la-fin-de-darkcomet/</link>
				<comments>https://blog.tchernobyl.ml/fun/malware-hunting-2-la-fin-de-darkcomet/#respond</comments>
				<pubDate>Tue, 14 May 2019 18:36:13 +0000</pubDate>
		<dc:creator><![CDATA[Tch3rn0byl]]></dc:creator>
				<category><![CDATA[Fun]]></category>
		<category><![CDATA[Système]]></category>
		<category><![CDATA[Vie Privée]]></category>
		<category><![CDATA[Virus]]></category>

		<guid isPermaLink="false">https://blog.tchernobyl.ml/?p=983</guid>
				<description><![CDATA[<div class="post-excerpt">Salut tout le monde! Je ne sais pas vous mais lorsque j&#8217;étais plus jeune, il y avait eu une énorme tendance à faire des vidéos et des tutos de hacking&#8230;</div><div class="post-more"><a href="https://blog.tchernobyl.ml/fun/malware-hunting-2-la-fin-de-darkcomet/" class="btn btn-primary btn-effect"><span>Lire l&#039;Article</span><span><i class="icon icon-arrow-right"></i></span></a></div>]]></description>
								<content:encoded><![CDATA[<p>Salut tout le monde! </p>
<p>Je ne sais pas vous mais lorsque j&rsquo;étais plus jeune, il y avait eu une énorme tendance à faire des vidéos et des tutos de hacking sur Windows. C&rsquo;était d&rsquo;ailleurs à cette époque que des outils comme <strong>LOIC</strong> sont devenus populaires étant donné que le hacking s&rsquo;était vulgarisé à en devenir littéralement du « point to click » comme dans les jeux vidéos.</p>
<p>Aujourd&rsquo;hui, dans ce nouvel opus de cette mini-série nous allons traiter d&rsquo;un logiciel devenu populaire à ce moment-là: <strong>DarkComet</strong></p>
<h3> Pour la petite histoire </h3>
<p>DarkComet était un cheval de Troie (Un type de logiciel connu sous son abréviation anglaise « RAT ») développé par un programmeur indépendant Français. </p>
<p>Bien que ce logiciel ait été développé en 2008, il a néanmoins commencé à proliférer au début de l&rsquo;année 2012. Le developpement du logiciel fut annulé, partiellement à cause de son utilisation pendant la guerre civile syrienne pour surveiller des activistes, mais aussi car son créateur avait peur qu&rsquo;il soit arrêté.</p>
<h3> Utilisation </h3>
<p>Il est à noter que même si son developpement a été arrêté en juillet 2012, le logiciel est toujours largement utilisé en France comme le montre ces statistiques toutes fraîches que j&rsquo;ai concocté avec l&rsquo;aide de Shodan:</p>
<p><img src="https://blog.tchernobyl.ml/https://blog.tchernobyl.ml/wp-content/uploads/2019/05/test-1-800x600.jpg" alt="" width="800" height="600" class="alignnone size-medium wp-image-1002" /><figcaption>Des stats toutes fraîches :) </figcaption>Comme on peut le voir, sur le nombre de serveurs de Contrôle et de Commandes que la plateforme a pu recenser en France, plus de 50% des 5 chevaux de Troie les plus répandus dans l&rsquo;hexagone sont des serveurs DarkComet.</p>
<p>Si le cadre de l&rsquo;article précédent existait (mise en place de véritables fondements au hacking éthique) et que l&rsquo;on souhaitait frapper un grand coup, il faudrait probablement s&rsquo;attaquer aux serveurs DarkComet car ceux-ci représentent à eux seuls 50% du parc cybermalveillant français.</p>
<h3> Ce que l&rsquo;on sait déjà </h3>
<p>Darkcomet a déjà par le passé été victime d&rsquo;une vulnérabilité. En effet, depuis 2015, on sait qu&rsquo;il est possible de provoquer une « Arbitrary File Download » ou téléchargement de fichier arbitraire en français sur n&rsquo;importe quel serveur DarkComet. Cependant, bien que cette vulnérabilité soit intéressante elle n&rsquo;est pas critique pour le serveur.Un point de départ logique serait donc d&rsquo;examiner la fonctionnalité d&rsquo;envois de fichiers de DarkComet (de serveur à ordinateur infecté).</p>
<p>Le serveur utilise un modèle de transaction bien précis qui ressemble à celui-ci (« S » désigne le serveur et « I » l&rsquo;ordinateur infecté):</p>
<pre>
S: QUICKUP C:unfichier.jpg | 123 | UPLOADEXEC
Le client initie une nouvelle connection avec "QUICKUP"

I: QUICKUP 123 | C:unfichier.jpg | UPLOADEXEC
S: "x41x00x43"
I: Ack
S: "longueur du fichier"
I: Ack
S: "flux binaire brut"
</pre>
<p>Le serveur C&amp;C ne vérifie pas s&rsquo;il a déjà émis une commande de téléchargement. Ce qui signifie que toute personne se connectant au serveur peut télécharger n’importe quel fichier du serveur.<br />
Malheureusement, comme il n’existe aucun moyen de faire en sorte que le serveur répertorie tous les fichiers d’un répertoire, cette vulnérabilité est limitée au téléchargement de fichiers connus de l&rsquo;attaquant. </p>
<p>Parmis les divers fichiers que l&rsquo;on peut atteindre, on peut s&rsquo;amuser à viser deux fichiers sensibles pour le serveur: </p>
<p>1°) comet.db qui comme son nom l&rsquo;indique est une base de donnée (SQLite) qui contient une liste de tous les ordinateurs infectés (dont adresses IP/MAC, Pays, nom d&rsquo;utilisateur courant, version du système d&rsquo;exploitation&#8230;). Cette base de donnée peut aussi contenir des données d&rsquo;enregistrement de frappes au claviers.</p>
<p>2°) config.ini qui contient en clair tous les mots de passes relatifs à la configuration du serveur DarkComet.</p>
<p>Vous l&rsquo;avez compris, cette vulnérabilité est pour le moins intéressante mais malheureusement, elle ne nous permet pas directement de mettre la main sur le serveur. </p>
<h3> Un peu de recherche </h3>
<p>Examinons maintenant la fonction de téléchargement des fichiers (d&rsquo;ordinateur infecté à serveur).<br />
Lorsque le serveur DarkComet tente de télécharger un fichier, voici ce qui se passe:</p>
<pre>
S: DOWNLOADFILE 596 | C:unfichier.jpg
Le client ouvre alors une nouvelle connexion:

I: FILETRANSFER | 596
S: "x41x00x43"
I: FILEBOF C:unfichier.jpg | 0
S: Ack
I: "flux binaire brut"
</pre>
<p>Le serveur va écrire le fichier dans un répertoire spécifié par l&rsquo;utilisateur avec le nom « fichier.jpg ». Bien qu&rsquo;en apparence, cela puisse sembler tout autant exploitable que la précédente fonction, ça ne l&rsquo;est malheureusement pas. En effet, Le 596 dans « DOWNLOADFILE 596 » est l&rsquo;identifiant de <a href="https://fr.wikipedia.org/wiki/Socket" rel="noopener noreferrer" target="_blank">socket</a> du client et le serveur n&rsquo;accepterait pas FILETRANSFER | 596 s&rsquo;il n&rsquo;a pas précédement émis sur un socket identique.</p>
<p>Même si elle n&rsquo;est pas évidente aux premiers abords, la vulnérabilité est bien là. Je laisse d&rsquo;ailleurs le détail pour ceux à qui ça interesse à l&rsquo;ami <strong>PseudoLaboratories</strong> qui est l&rsquo;auteur de la trouvaille.</p>
<p>Tout ça pour dire que l&rsquo;exploitation de la vulnérabilité nous mène à un envoie de fichier arbitraire. Envoie que l&rsquo;on peut utiliser pour provoquer une: *roulement de tambours*&#8230;</p>
<h3> Exécution de code à distance </h3>
<p>En effet, le serveur DarkComet essaiera par défaut d’utiliser UPnP pour ouvrir automatiquement les ports. Pour ce faire, il écrit un fichier appelé « upnp.exe » dans le répertoire Temp et l’appelle si nécessaire. </p>
<p>Il suffit donc que l&rsquo;on se serve dans un premier temps de la vulnérabilité de téléchargement de fichiers arbitraire afin de lire le nom d&rsquo;utilisateur courant puis dans un second temps, que l&rsquo;on se serve de la vulnérabilité d&rsquo;envoi de fichiers arbitraire afin d&rsquo;envoyer notre code dans le bon répertoire. </p>
<p>Au prochain démarrage du serveur, « upnp.exe » et ainsi notre code sera exécuté.</p>
<h3> Élévation des privilèges </h3>
<p>La suite naturelle des choses serait de trouver un moyen de devenir administrateur sauf qu&rsquo;ici le travail est déjà mâché par DarkComet. </p>
<p>En effet, comme le logiciel demande les privilèges administrateur à chaque démarrage, par principe d&rsquo;héritage, tout code exécuté par celui-ci est donc exécuté avec les privilèges administrateur, incluant donc notre code.</p>
<h3>Conclusion</h3>
<p>DarkComet est un logiciel très bien développé, à tel point qu&rsquo;il s&rsquo;agisse du trojan le plus populaire en France, et d&rsquo;ailleurs un des plus populaire dans le monde. Il est à peu près certains que si le développement du logiciel était toujours d&rsquo;actualité, les failles citées dans cet article ne seraient plus exploitables depuis un long moment. </p>
<p>Seulement voilà, comme dit plus haut en guise d&rsquo;avertissement déguisé, on pourrait, seulement à l&rsquo;aide de ces deux vulnérabilités, nettoyer 50% du parc cybermalveillant français, d&rsquo;un coup, sans forcer, si bien sûr le cadre de l&rsquo;article précédent existait (mise en place de véritables fondements au hacking éthique, etc..) </p>
<p>J&rsquo;espère que cette article vous a plu, n&rsquo;hésitez pas à laisser un commentaire, une remarque, ou même un message (je les lis tous et je répond généralement rapidement). </p>
<p>En ce qui me concerne, j&rsquo;ai été ravis d&rsquo;écrire cet article, je n&rsquo;ai cependant pas encore choisi ma prochaine victime alors n&rsquo;hésitez pas à m&rsquo;envoyer des idées :)</p>
<h3>Sources</h3>
<p>https://pseudolaboratories.github.io/DarkComet-upload-vulnerability/<br />
https://www.shodan.io/<br />
https://techanarchy.net/blog/darkcomet-hacking-the-hacker<br />
https://fr.wikipedia.org/wiki/DarkComet</p>
]]></content:encoded>
							<wfw:commentRss>https://blog.tchernobyl.ml/fun/malware-hunting-2-la-fin-de-darkcomet/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
							</item>
		<item>
		<title>Malware Hunting 1/? : Introduction</title>
		<link>https://blog.tchernobyl.ml/fun/malware-hunting-1-introduction/</link>
				<comments>https://blog.tchernobyl.ml/fun/malware-hunting-1-introduction/#respond</comments>
				<pubDate>Sun, 05 May 2019 19:14:33 +0000</pubDate>
		<dc:creator><![CDATA[Tch3rn0byl]]></dc:creator>
				<category><![CDATA[Fun]]></category>
		<category><![CDATA[Système]]></category>
		<category><![CDATA[Vie Privée]]></category>
		<category><![CDATA[Virus]]></category>
		<category><![CDATA[Web]]></category>

		<guid isPermaLink="false">https://blog.tchernobyl.ml/?p=886</guid>
				<description><![CDATA[<div class="post-excerpt">Coucou tout le monde, Lorsque l&#8217;on parle d&#8217;invasions extraterrestres, un des premiers films qui me vient en tête c&#8217;est Independance Day. Dans ce film, les humains sont confrontés à une&#8230;</div><div class="post-more"><a href="https://blog.tchernobyl.ml/fun/malware-hunting-1-introduction/" class="btn btn-primary btn-effect"><span>Lire l&#039;Article</span><span><i class="icon icon-arrow-right"></i></span></a></div>]]></description>
								<content:encoded><![CDATA[<p>Coucou tout le monde,</p>
<p>Lorsque l&rsquo;on parle d&rsquo;invasions extraterrestres, un des premiers films qui me vient en tête c&rsquo;est Independance Day. Dans ce film, les humains sont confrontés à une invasion massive de vilains aliens.</p>
<p>Même s&rsquo;ils ont essayé de lutter, ils ne faisaient clairement pas le poids contre une civilisation alien nettement plus avancée technologiquement. C&rsquo;est alors qu&rsquo;à un moment, étant fatigués d&rsquo;essayer de détruire un à un les vilains vaisseaux aliens, un informaticien dans le film a carrément l&rsquo;idée de détruire le vaisseau mère à l&rsquo;aide d&rsquo;un virus informatique ainsi que d&rsquo;une ogive nucléaire (le virus visant à créer une attaque informatique de grande ampleur sur les vaisseaux sur Terre et l&rsquo;ogive, à mettre H.S le vaisseau mère).<br />
</p>
<figure>
    <img src='https://media.giphy.com/media/3o6gE2qaKdNm3diaFa/giphy.gif' alt='missing' /><figcaption style="font-size:0.85em">On constate effectivement de légères lacunes technologiques pour les humains</figcaption></figure>
<p></p>
<p>C&rsquo;est à ce moment-là que je vois venir les hordes de semi-questions du type: « Je ne vois pas le rapport avec le titre de l&rsquo;article ? »</p>
<p>Comme j&rsquo;aime troller, je vais vous répondre par une question simple (oui oui, répondre par une question :) ) :</p>
<p><strong><em>Que se passerait-il si au lieu de recenser et de traiter les ordinateurs infectés par des <del datetime="2019-05-05T18:00:04+00:00">vaisseaux aliens</del> logiciels malveillants, on recensait et on traitait <del datetime="2019-05-05T18:00:04+00:00">les vaisseaux mères</del> les serveurs de Contrôle et de Commande (C&amp;C) ?</em></strong></p>
<p>Cette idée ne vient pas de moi, en réalité, elle existe depuis plusieurs années et porte le doux nom de « Malware Hunting ».</p>
<p>Pour expliquer le principe, il n&rsquo;y a pas plus simple:</p>
<p>1°) Repérer un logiciel malveillant<br />
2°) « L&rsquo;interroger » afin de connaître son serveur C&amp;C (Contrôle et Commande)<br />
3°) Remonter l&rsquo;information aux autorités compétentes</p>
<p>Partant de cette définition, mon article sur la dissection d&rsquo;une attaque de masse chinoise (<a href="https://blog.tchernobyl.ml/fun/dissection-dune-attaque-de-masse-chinoise/">ici</a>) s&rsquo;apparente à du Malware Hunting.</p>
<p>Pour moi, cette idée est le but final du fameux Hacking Ethique. En effet, aujourd&rsquo;hui l&rsquo;Ethical Hacking comme aiment bien l&rsquo;appeler nos amis anglo-saxons, ne se limite pricipalement qu&rsquo;au remontées de failles.</p>
<p>Or je trouve assez triste de me dire que la seule chose d&rsquo;éthique dans le hacking c&rsquo;est de remonter des failles. Sérieusement, on en fait quoi du fait de délivrer des miliers d&rsquo;ordinateurs de quelqu&rsquo;un qui se croit tout permis ? On en fait quoi de nos serveurs qui cèdent à la barbarie du minage de cryptomonnaie ou encore de ces jeunes collégiens qui, guidés par des tutos, se mettent à télécharger des logiciels infectés en pensant qu&rsquo;ils vont devenirs de gros caïds 2.0 pleins aux as (cf. <a href="https://blog.tchernobyl.ml/systeme/les-r-a-t-ou-les-pires-arnaques-du-web/">ici</a>)</p>
<p></p>
<figure>
    <img src='https://media.giphy.com/media/8xgqLTTgWqHWU/giphy.gif' alt='missing' /><br />
</figure>
<p></p>
<p>Honnêtement, j&rsquo;adorerais tellement voir un jour, un état mettre en place de VRAIS fondements au hacking éthique.<br />
Je pense que ça pourrait avoir de grosses répercussions sociétales. En effet, ça pourrait changer l&rsquo;image de voleur 2.0 inhérente au hacker et on pourrait même voir apparaître un phénomène de mode non plus de vidéos ou d&rsquo;articles sur comment attaquer de pauvres ordinateurs mais plutôt sur comment identifier un botnet et le remonter aux autorités.</p>
<p>Ces mêmes autorités pourraient avoir la mission de s&rsquo;assurer qu&rsquo;il ne s&rsquo;agisse pas d&rsquo;un pauvre site infecté qui fait office de relais aux vrai C&amp;C et ainsi donner le feu vert de l&rsquo;attaquer via un système de listes noires publiques d&rsquo;adresses IP comme il en existe déjà sur de nombreux sites spécialisés. Sans compter bien sûr tout le bénéfice que cela pourrait avoir en matière d&#8217;emplois.</p>
<p>Même si je sais que je pars peut-être un peu loin, je suis sûr que c&rsquo;est faisable et que ça peut être une très bonne solution à un problème d&rsquo;insécurité informatique majeure que l&rsquo;on a aujourd&rsquo;hui en France et dans de nombreux pays.</p>
<p>En attendant le deuxième épisode qui devrait être un peu plus amusant et un peu moins théorique, j&rsquo;espère que le début de cette mini-série vous a captivé pour la suite. Je voulais aussi tous vous remercier d&rsquo;être toujours plus nombreux à visiter le site et à m&rsquo;envoyer tout pleins de messages super encourageants :) .</p>
<p>À très bientôt les margoulins !</p>
]]></content:encoded>
							<wfw:commentRss>https://blog.tchernobyl.ml/fun/malware-hunting-1-introduction/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
							</item>
	</channel>
</rss>
